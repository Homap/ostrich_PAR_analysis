sex_averaged_map <- read.table("../../data/geneticmap/sex_averaged_smoothed.1MB.window.Z.txt", header=T)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window/kb)
sex_averaged_map
rho_mb <- read.table("../../data/rho/ldhat_rho/z/1Mb1Mb.rho.chrom.Z.txt", header=T)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window/kb)
sex_averaged_map <- read.table("../../data/geneticmap/sex_averaged_smoothed.1MB.window.Z.txt", header=T)
sex_averaged_map
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window/kb)
cor.test(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window/kb)
scaled_cm <- scale(sex_averaged_map$CM_per_bp*mb)
scaled_rho <- scale(rho_mb$rho_per_window/kb)
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
summary(full_Z)
intervals(full_Z, which = "all")
loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start)
predict(f)
sex_averaged_map <- read.table("../../data/geneticmap/sex_averaged.1MB.window.Z.txt", header=T)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start)
predict(f)
sex_averaged_map
rho_mb <- rho_mb[2:79,]
dim(rho_mb)
sex_averaged_map <- predict(sex_averaged_map )
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start)
h <- predict(f)
plot(h, rho_mb$rho_per_window/kb)
cor.test(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window/kb)
cor.test(h, rho_mb$rho_per_window/kb)
scaled_cm <- scale(h)
scaled_rho <- scale(rho_mb$rho_per_window/kb)
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
summary(full_Z)
intervals(full_Z, which = "all")
plot(sex_averaged_map$Window_start, sex_averaged_map$CM_per_bp*m)
plot(sex_averaged_map$Window_start, sex_averaged_map$CM_per_bp*mb)
lines(h, col = "red")
plot(sex_averaged_map$Window_start, sex_averaged_map$CM_per_bp*mb)
lines(sex_averaged_map$Window_start, h, col = "red")
plot(sex_averaged_map$Window_start[2:79,], sex_averaged_map$CM_per_bp[2:79]*mb)
plot(sex_averaged_map$Window_start[2:79,], sex_averaged_map$CM_per_bp[2:79,]*mb)
plot(sex_averaged_map$Window_start[2:79], sex_averaged_map$CM_per_bp[2:79]*mb)
lines(sex_averaged_map$Window_start, h, col = "red")
h
sex_averaged_map$Window_start[2:79]
plot(sex_averaged_map$Window_start[2:79], sex_averaged_map$CM_per_bp[2:79]*mb)
lines(sex_averaged_map$Window_start[2:79], h, col = "red")
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, span = 5)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], sex_averaged_map$CM_per_bp[2:79]*mb)
lines(sex_averaged_map$Window_start[2:79], h, col = "red")
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, span = 2)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], sex_averaged_map$CM_per_bp[2:79]*mb)
lines(sex_averaged_map$Window_start[2:79], h, col = "red")
rho_mb <- rho_mb[2:79,]
lines(sex_averaged_map$Window_start[2:79], h, col = "red")
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, span = 2)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], sex_averaged_map$CM_per_bp[2:79]*mb)
lines(sex_averaged_map$Window_start[2:79], h, col = "red")
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, formula = "polynomial")
summ(par_autosome)
summary(par_autosome)
rho_mb <- read.table("../../data/rho/ldhat_rho/z/1Mb1Mb.rho.chrom.Z.txt", header=T)
sex_averaged_map <- read.table("../../data/geneticmap/sex_averaged.1MB.window.Z.txt", header=T)
plot(sex_averaged_map$Window_start[2:79], sex_averaged_map$CM_per_bp[2:79]*mb)
plot(sex_averaged_map$Window_start, sex_averaged_map$CM_per_bp*mb)
rho_mb <- read.table("../../data/rho/ldhat_rho/z/1Mb1Mb.rho.chrom.Z.txt", header=T)
sex_averaged_map <- read.table("../../data/geneticmap/sex_averaged.1MB.window.Z.txt", header=T)
plot(sex_averaged_map$Window_start, sex_averaged_map$CM_per_bp*mb)
plot(rho_mb$rho_per_window, sex_averaged_map$CM_per_bp*mb)
f = lm(rho_mb$rho_per_window~ sex_averaged_map$CM_per_bp*mb)
plot(rho_mb$rho_per_window, sex_averaged_map$CM_per_bp*mb)
cor.test(h, rho_mb$rho_per_window/kb)
cor.test(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window/kb)
f = lm(rho_mb$rho_per_window ~ sex_averaged_map$CM_per_bp*mb)
f = lm(rho_mb$rho_per_window ~ sex_averaged_map$CM_per_bp)
f = lm(rho_mb$rho_per_window ~ (sex_averaged_map$CM_per_bp*mb))
h = sex_averaged_map$CM_per_bp*mb
f = lm(rho_mb$rho_per_window ~ h)
f
lines(f)
l = predic(f)
l = predict(f)
lines(f)
lines(l)
l
abline(lm(rho_mb$rho_per_window ~ h))
plot(h, rho_mb$rho_per_window/kb)
plot(h, rho_mb$rho_per_window/kb)
abline(lm(rho_mb$rho_per_window ~ h))
rho_mb <- read.table("../../data/rho/ldhat_rho/z/1Mb1Mb.rho.chrom.Z.txt", header=T)
sex_averaged_map <- read.table("../../data/geneticmap/sex_averaged.1MB.window.Z.txt", header=T)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window/kb)
plot(sex_averaged_map$CM_per_bp, rho_mb$rho_per_window)
abline(lm(rho_mb$rho_per_window ~ sex_averaged_map$CM_per_bp), col = "red")
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window, xlim = c(0, 5))
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window, xlim = c(0, 3))
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window, xlim = c(0, 3), ylim = c(200, 2000))
abline(lm(rho_mb$rho_per_window ~ sex_averaged_map$CM_per_bp), col = "red")
savg_map <- sex_averaged_map$CM_per_bp*mb
abline(lm(rho_mb$rho_per_window ~ savg_map), col = "red")
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window, xlim = c(0, 3), ylim = c(200, 2000))
savg_map <- sex_averaged_map$CM_per_bp*mb
abline(lm(rho_mb$rho_per_window ~ savg_map), col = "red")
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window)
savg_map <- sex_averaged_map$CM_per_bp*mb
abline(lm(rho_mb$rho_per_window ~ savg_map), col = "red")
g <- lm(rho_mb$rho_per_window ~ savg_map)
summary(g)
sex_averaged_map[which(sex_averaged_map$CM_per_bp*mb < 4),]
sex_averaged_map[which(sex_averaged_map$CM_per_bp*mb > 4),]
sex_averaged_map <- read.table("../../data/geneticmap/kosambi_sex_averaged.txt", header=T)
head(sex_averaged_map)
plot(sex_averaged_map$start, sex_averaged_map$pair_cm)
sex_averaged_map <- read.table("../../data/geneticmap/kosambi_sex_averaged_smoothed.txt", header=T)
plot(sex_averaged_map$start, sex_averaged_map$pair_cm)
sex_averaged_map <- read.table("../../data/geneticmap/female.1MB.window.Z.txt", header=T)
head(sex_averaged_map)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window)
sex_averaged_map <- read.table("../../data/geneticmap/female.1MB.window.Z.txt", header=T)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window)
sex_averaged_map <- read.table("../../data/geneticmap/male.1MB.window.Z.txt", header=T)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window)
savg_map <- sex_averaged_map$CM_per_bp*mb
g <- lm(rho_mb$rho_per_window ~ savg_map)
abline(lm(rho_mb$rho_per_window ~ savg_map), col = "red")
summary(g)
sex_averaged_map <- read.table("../../data/geneticmap/sex_averaged.1MB.window.Z.txt", header=T)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window)
savg_map <- sex_averaged_map$CM_per_bp*mb
g <- lm(rho_mb$rho_per_window ~ savg_map)
abline(lm(rho_mb$rho_per_window ~ savg_map), col = "red")
summary(g)
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
summary(full_Z)
intervals(full_Z, which = "all")
intervals(full_Z, which = "all")
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
summary(full_Z)
intervals(full_Z, which = "all")
scaled_cm <- scale(sex_averaged_map$CM_per_bp*mb)
scaled_rho <- scale(rho_mb$rho_per_window/kb)
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
summary(full_Z)
intervals(full_Z, which = "all")
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window, xlim = c(0,2), ylim = c(300, 1500))
savg_map <- sex_averaged_map$CM_per_bp*mb
g <- lm(rho_mb$rho_per_window ~ savg_map)
abline(lm(rho_mb$rho_per_window ~ savg_map), col = "red")
summary(g)
cor.test(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window/kb)
0.3231046 ^2
plot(rho_mb$Window_start, rho_mb$rho_per_window)
rho_mb <- read.table("../../data/rho/ldhat_rho/z/1Mb1Mb.rho.chrom.Z.txt", header=T)
plot(rho_mb$Window_start, rho_mb$rho_per_window)
rho_mb
rho_mb <- read.table("../../data/rho/ldhat_rho/z/1Mb1Mb.rho.chrom.Z.txt", header=T)
getwd()
setwd("~/Library/Group Containers/G69SCX94XU.duck/Library/Application Support/duck/Volumes/ostrichZ/ostrich_z/bin/code/statistical_analysis")
rho_mb <- read.table("../../data/rho/ldhat_rho/z/1Mb1Mb.rho.chrom.Z.txt", header=T)
tail(rho_mb)
rho_mb <- read.table("../../data/rho/ldhat_rho/z/1Mb1Mb.rho.chrom.Z.txt", header=T)
rho_mb
sex_averaged_map <- read.table("../../data/geneticmap/sex_averaged.1MB.window.Z.txt", header=T)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window)
plot(rho_mb$Window_start, rho_mb$rho_per_window)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window)
savg_map <- sex_averaged_map$CM_per_bp*mb
g <- lm(rho_mb$rho_per_window ~ savg_map)
abline(lm(rho_mb$rho_per_window ~ savg_map), col = "red")
summary(g)
scaled_cm <- scale(sex_averaged_map$CM_per_bp*mb)
scaled_rho <- scale(rho_mb$rho_per_window/kb)
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
summary(full_Z)
intervals(full_Z, which = "all")
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, formula = "polynomial")
, formula = "polynomial"
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start)
h <- predict(f)
plot(rho_mb$rho_per_window, h)
h
length(h)
plot(rho_mb$rho_per_window[2:79], h)
abline(lm(rho_mb$rho_per_window ~ h))
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
plot(rho_mb$rho_per_window[2:79], h)
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
scaled_cm <- scale(h)
scaled_rho <- scale(rho_mb$rho_per_window/kb)
e <- data.frame(scaled_cm, scaled_rho)
scaled_rho <- scale(rho_mb$rho_per_window[2:79]/kb)
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
summary(full_Z)
rm(list = ls())
#-----------
# rho vs. cM/Mb
#-----------
mb = 10^6
rho_mb <- read.table("../../data/rho/ldhat_rho/z/1Mb1Mb.rho.chrom.Z.txt", header=T)
sex_averaged_map <- read.table("../../data/geneticmap/sex_averaged.1MB.window.Z.txt", header=T)
plot(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window)
savg_map <- sex_averaged_map$CM_per_bp*mb
g <- lm(rho_mb$rho_per_window ~ savg_map)
abline(lm(rho_mb$rho_per_window ~ savg_map), col = "red")
summary(g)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start)
h <- predict(f)
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
lmodel <- lm(rho_mb$rho_per_window[2:79] ~ h)
summary(lmodel)
scaled_cm <- scale(h)
scaled_rho <- scale(rho_mb$rho_per_window[2:79]/kb)
e <- data.frame(scaled_cm, scaled_rho)
kb = 1000
scaled_cm <- scale(h)
scaled_rho <- scale(rho_mb$rho_per_window[2:79]/kb)
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
summary(full_Z)
intervals(full_Z, which = "all")
intervals(full_Z, which = "var_cov")
intervals(full_Z, which = "var-cov")
plot(sex_averaged_map$Window_start[2:79], h)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, degree = 2, span = 0.5)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, degree = 2, span = 0.2)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
plot(h, rho_mb$rho_per_window[2:79])
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, degree = 2, span = 0.3)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, degree = 2, span = 0.5)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
lmodel <- lm(rho_mb$rho_per_window[2:79] ~ h)
summary(lmodel)
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
lmodel <- lm(rho_mb$rho_per_window[2:79] ~ h)
summary(lmodel)
kb = 1000
scaled_cm <- scale(h)
scaled_rho <- scale(rho_mb$rho_per_window[2:79]/kb)
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
scaled_rho <- scale(rho_mb$rho_per_window[2:79]/kb)
e <- data.frame(scaled_cm, scaled_rho)
e$obs <- as.numeric(rownames(e))
e
full_Z <- gls(scaled_cm ~ + scaled_rho, na.action="na.exclude", method = "ML", correlation = corAR1(form =~ obs), data = e )
summary(full_Z)
intervals(full_Z, which = "var-cov")
lmodel <- lm(rho_mb$rho_per_window[2:79] ~ h)
summary(lmodel)
cor.test(rho_mb$rho_per_window[2:79] ~ h)
cor.test(rho_mb$rho_per_window[2:79] , h)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, degree = 2, span = 0.4)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
lmodel <- lm(rho_mb$rho_per_window[2:79] ~ h)
summary(lmodel)
cor.test(rho_mb$rho_per_window[2:79] , h)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, degree = 2, span = 0.3)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
lmodel <- lm(rho_mb$rho_per_window[2:79] ~ h)
summary(lmodel)
cor.test(rho_mb$rho_per_window[2:79] , h)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, degree = 2, span = 0.2)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
lmodel <- lm(rho_mb$rho_per_window[2:79] ~ h)
summary(lmodel)
cor.test(rho_mb$rho_per_window[2:79] , h)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, degree = 2, span = 0.1)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
lmodel <- lm(rho_mb$rho_per_window[2:79] ~ h)
summary(lmodel)
cor.test(rho_mb$rho_per_window[2:79] , h)
plot(sex_averaged_map$Window_start[2:79], h)
f <- loess(sex_averaged_map$CM_per_bp*mb~sex_averaged_map$Window_start, degree = 2, span = 0.2)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
lmodel <- lm(rho_mb$rho_per_window[2:79] ~ h)
summary(lmodel)
cor.test(rho_mb$rho_per_window[2:79] , h)
h <- predict(f)
plot(sex_averaged_map$Window_start[2:79], h)
plot(h, rho_mb$rho_per_window[2:79])
abline(lm(rho_mb$rho_per_window[2:79] ~ h))
rho_data <- read.table("../../data/rho/ldhat_rho/z/200Kb50Kb_rho_Z.chr.coord.txt", header=F)
colnames(rho_data) <- c("Chr", "Window_start", "Window_end", "scaffold", "start", "end", "rho_per_site", "rho_per_window")
mean(rho_data$rho_per_site)
mean(rho_data$rho_per_site, na.rm = T)
rho_data_a <- read.table("../../data/rho/ldhat_rho/chr4/superscaffold11.map.length.txt", header=F)
head(rho_data_a)
rho_data_a <- read.table("../../data/rho/ldhat_rho/chr4/superscaffold11.map.length.txt", header=T)
head(rho_data_a)
mean(rho_data_a$)
mean(rho_data_a$Mean_rho)
mean(rho_data_a$Mean_rho/(rho_data_a$Locus_end-rho_data_a$Locus_start))
mean(rho_data$rho_per_site, na.rm = T)
par_rho <- rho_data[rho_data$Window_start<52185292,]
mean(par_rho$rho_per_site, na.rm = T)
rho_data_a <- read.table("../../data/rho/ldhat_rho/chr5/superscaffold8.map.length.txt", header=T)
head(rho_data_a)
mean(rho_data_a$Mean_rho/(rho_data_a$Locus_end-rho_data_a$Locus_start))
(0.0008037617+0.0006222308)(2)
(0.0008037617+0.0006222308)/(2)
getwd()
points(sex_averaged_map$CM_per_bp*mb, rho_mb$rho_per_window, col = "red")
savg_map <- sex_averaged_map$CM_per_bp*mb
g <- lm(rho_mb$rho_per_window ~ savg_map)
abline(lm(rho_mb$rho_per_window ~ savg_map), col = "red")
summary(g)
# PAR
ld_decay_par <- read.table("../../data/ld/ld_decay/z/par/PAR.bin")
colnames(ld_decay_par) = c("Dist", "Mean_r2", "Mean_Dprime", "Sum_r2", "Sum_Dprime", "NumberPairs")
ld_decay_par
median(ld_decay_par$Mean_r2)
hist(ld_decay_par$Mean_r2)
mode(ld_decay_par$Mean_r2)
median(ld_decay_par$Mean_r2)
median(ld_decay_nonpar$Mean_r2)
# nonPAR
ld_decay_nonpar <- read.table("../../data/ld/ld_decay/z/nonpar/nonPAR.bin")
colnames(ld_decay_nonpar) = c("Dist", "Mean_r2", "Mean_Dprime", "Sum_r2", "Sum_Dprime", "NumberPairs")
median(ld_decay_nonpar$Mean_r2)
ld_decay_par
ld_decay_par[ld_decay_par<0.13,]
ld_decay_par[ld_decay_par$Mean_r2<0.13,]
median(ld_decay_par$Mean_r2)
ld_decay_par[ld_decay_par$Mean_r2<0.129,]
summary(par_autosome)
ld_decay_autosome <- read.table("../../data/ld/ld_decay/autosome/chr4_5.bin")
colnames(ld_decay_autosome) = c("Dist", "Mean_r2", "Mean_Dprime", "Sum_r2", "Sum_Dprime", "NumberPairs")
# PAR
ld_decay_par <- read.table("../../data/ld/ld_decay/z/par/PAR.bin")
colnames(ld_decay_par) = c("Dist", "Mean_r2", "Mean_Dprime", "Sum_r2", "Sum_Dprime", "NumberPairs")
# nonPAR
ld_decay_nonpar <- read.table("../../data/ld/ld_decay/z/nonpar/nonPAR.bin")
colnames(ld_decay_nonpar) = c("Dist", "Mean_r2", "Mean_Dprime", "Sum_r2", "Sum_Dprime", "NumberPairs")
# Summary statistics
autosome <- unclass(summary(ld_decay_autosome$Mean_r2))
PAR <- unclass(summary(ld_decay_par$Mean_r2))
nonPAR <- unclass(summary(ld_decay_nonpar$Mean_r2))
#ld_decay_3_cat <- cbind(data.frame(autosome, check.names = FALSE, stringsAsFactors = FALSE),
#  data.frame(PAR, check.names = FALSE, stringsAsFactors = FALSE),
#  data.frame(nonPAR, check.names = FALSE, stringsAsFactors = FALSE))
#write.table(ld_decay_3_cat, file=paste("ld_decay.tab"), sep='\t', quote=FALSE)
# Question: Number of pairs within bins: downsample to keep the same across categories or is fine as it is?
# Create data frame for GLM
ld_mat = matrix(ncol = 3, nrow = 6020)
for(i in seq(1,3010)){
ld_mat[i+i-1,1] <- as.numeric(ld_decay_autosome[i,1])
ld_mat[i+i,1] <- as.numeric(ld_decay_par[i,1])
ld_mat[i+i-1,2] <- "A"
ld_mat[i+i,2] <- "PAR"
ld_mat[i+i-1,3] <- ld_decay_autosome[i,2]
ld_mat[i+i,3] <- ld_decay_par[i,2]
}
# Data set
ld_df <- data.frame(ld_mat, stringsAsFactors = TRUE)
colnames(ld_df) <- c("Dist", "A_PAR", "r2")
ld_df$Dist<-as.numeric(as.vector(ld_df$Dist))
ld_df$r2<-as.numeric(as.vector(ld_df$r2))
ld_df$r2_events<-round(ld_df$r2*100,0)
ld_df$r2_trials<-100-ld_df$r2_events
head(ld_df)
# GLM with binomial
#Full model
par_autosome <- glm(cbind(r2_events,r2_trials) ~ A_PAR + log(Dist) + log(Dist):A_PAR, data = ld_df,family=binomial)
summary(par_autosome)
summ(par_autosome)
Anova(par_autosome, test = "Wald",type=3)
ld_mat[i+i,2] <- "nonPAR"
ld_mat[i+i-1,3] <- ld_decay_autosome[i,2]
# Create data frame for GLM
ld_mat = matrix(ncol = 3, nrow = 6020)
for(i in seq(1,3010)){
ld_mat[i+i-1,1] <- as.numeric(ld_decay_autosome[i,1])
ld_mat[i+i,1] <- as.numeric(ld_decay_par[i,1])
ld_mat[i+i-1,2] <- "A"
ld_mat[i+i,2] <- "nonPAR"
ld_mat[i+i-1,3] <- ld_decay_autosome[i,2]
ld_mat[i+i,3] <- ld_decay_par[i,2]
}
# Data set
ld_df <- data.frame(ld_mat, stringsAsFactors = TRUE)
colnames(ld_df) <- c("Dist", "A_PAR", "r2")
ld_df$Dist<-as.numeric(as.vector(ld_df$Dist))
ld_df$r2<-as.numeric(as.vector(ld_df$r2))
ld_df$r2_events<-round(ld_df$r2*100,0)
ld_df$r2_trials<-100-ld_df$r2_events
head(ld_df)
#Full model
par_autosome <- glm(cbind(r2_events,r2_trials) ~ A_PAR + log(Dist) + log(Dist):A_PAR, data = ld_df,family=binomial)
summary(par_autosome)
summ(par_autosome)
Anova(par_autosome, test = "Wald",type=3)
getwd()
setwd("~/Library/Group Containers/G69SCX94XU.duck/Library/Application Support/duck/Volumes/ostrichZ/ostrich_z/bin/code/analysis/diversity")
pi <- read.table("test_pi", header=T)
head(pi)
pi <- read.table("test_pi", header=F)
head(pi)
plot((pi$V2+pi$V3)/(2*mb), pi$V8)
plot((pi$V2+pi$V3)/(2*mb), pi$V8/200000)
plot((pi$V2+pi$V3)/(2*mb), pi$V9/200000, col = "red")
plot((pi$V2+pi$V3)/(2*mb), pi$V10/200000)
plot((pi$V2+pi$V3)/(2*mb), pi$V8/V11)
plot((pi$V2+pi$V3)/(2*mb), pi$V8/pi$V11)
getwd()
setwd("~/Library/Group Containers/G69SCX94XU.duck/Library/Application Support/duck/Volumes/ostrichZ/ostrich_z/bin/code/statistical_analysis")
rho <- read.table("../../data/rho/ldhat_rho/z/200Kb200Kb_rho_Z.chr.coord.txt")
head(rho)
dim(rho)
dim(pi)
points((rho$V2+rho$V3)/(2*mb), rho$V7, col = "red")
plot((pi$V2+pi$V3)/(2*mb), pi$V8/200000)
points((rho$V2+rho$V3)/(2*mb), rho$V7, col = "red")
pi <- read.table("../analysis/diversity/sorted_test_pit", header=F)
plot((pi$V2+pi$V3)/(2*mb), pi$V8/200000)
points((rho$V2+rho$V3)/(2*mb), rho$V7, col = "red")
plot(rho$V7, pi$V8/200000)
plot(rho$V7, pi$V9/200000)
l <- lm(pi$V8 ~ rho$V7)
summary(l)
abline(l)
abline(pi$V8 ~ rho$V7)
plot(rho$V7, pi$V8/200000)
abline(pi$V8 ~ rho$V7)
plot(rho$V7, pi$V8)
abline(pi$V8 ~ rho$V7)
plot((pi$V2+pi$V3), rho$V7/(pi$V8/200000))
plot((pi$V2+pi$V3)/(2*mb), rho$V7/(pi$V8/200000))
plot((pi$V2+pi$V3)/(2*mb), rho$V7/(pi$V8/200000), ylim=c(0, 2))
plot((pi$V2+pi$V3)/(2*mb), rho$V7/(pi$V8/200000), ylim=c(0, 5))
plot((pi$V2+pi$V3)/(2*mb), rho$V7/(pi$V8/200000), ylim=c(0, 2))
head(pi)
dim(pi)
setwd("~/Library/Group Containers/G69SCX94XU.duck/Library/Application Support/duck/Volumes/ostrichZ/ostrich_z/bin/code/statistical_analysis")
GC <- read.table("../../data/genomic_features/z_scaf.200000.intergene.overlap.density.sorted.coord.txt", header=T)
header(GC)
head(GC)
GC <- read.table("../../data/genomic_features/z_scaf.200000.intergene.overlap.density.sorted.coord.txt", header=F)
head(GC)
plot((GC$V2+GC$V3)/(2*mb), GC$V8/GC$V7)
plot((GC$V2+GC$V3)/(2*mb), GC$V12/GC$V11)
plot(GC$V12/GC$V11, pi$V8/200000)
plot(GC$V12/GC$V11, pi$V8)
abline(lm(pi$V8))
abline(lm(pi$V8))
abline(lm(pi$V8))
abline(lm(pi$V8~GC$V12/GC$V11))
t <- GC$V12/GC$V11
abline(lm(pi$V8~t))
hh <- lm(pi$V8~t)
summary(h)
summary(hh)
cor.test(pi$V8,t)
0.2445301^2
plot(GC$V8/GC$V7, pi$V8)
t <- GC$V8/GC$V7
abline(lm(pi$V8~t))
setwd("~/Library/Group Containers/G69SCX94XU.duck/Library/Application Support/duck/Volumes/ostrichZ/ostrich_z/bin/code/statistical_analysis")
gene <- read.table("../../data/genomic_features/z_scaf.200000..CDS.overlap.density.sorted.coord.txt")
head(gene)
plot((gene$V2+gene$V3)/(2*mb), gene$V12/gene$V11)
plot(GC$V8/GC$V7, gene$V12/gene$V11)
plot(GC$V8/GC$V7, gene$V12/gene$V11, ylim=c(0.3, 0.6))
getwd()
# Genetic diversity
pi <- read.table("../../data/diversity/genetic_variation/z/Z.200000.chr.coordinates.sfs.txt", header=T)
